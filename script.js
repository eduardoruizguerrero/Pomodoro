/*




                                    *****************************************************
                                    *   This code is made from Eduardo Ruiz Guerrero.   *
                                    *****************************************************




        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#######################%####%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%####################################%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%#########################################%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %%%%%%%%%%%%%%%%%%%%%%%%%%##############################################%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %%%%%%%%%%%%%%%%%%%%%%%####################################################%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %%%%%%%%%%%%%%%%%%%%%#######################################################%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %%%%%%%%%%%%%%%%%%%%##########################################################%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %%%%%%%%%%%%%%%%%%%############################################################%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %%%%%%%%%%%%%%%%%%##############################################################%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %%%%%%%%%%%%%%%%%################################################################%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %%%%%%%%%%%%%%%%######################################################%###########%%%%%%%%%%%%%%%%%%%%%%%%%%
        %%%%%%%%%%%%%%%#################%########*#@#######################################%%%%%%%%%%%%%%%%%%%%%%%%%
        %%%%%%%%%%%%%%###########################==+%#######################################%%%%%%%%%%%%%%%%%%%%%%%%
        %%%%%%%%%%%%%%###########################.._*#######################################%%%%%%%%%%%%%%%%%%%%%%%%
        %%%%%%%%%%%%%###########################%...=########%###############################%%%%%%%%%%%%%%%%%%%%%%%
        %%%%%%%%%%%%%@##########################*..._%#######*%####%%#####%%#################%%%%%%%%%%%%%%%%%%%%%%%
        %%%%%%%%%%%%#@@#########################*....+#######*=%###*+######+#################%%%%%%%%%%%%%%%%%%%%%%%
        %%%%%%%%%%%%#@@@######################%#*....-#%######.=%##=-%#####+%#################%%%%%%%%%%%%%%%%%%%%%%
        %%%%%%%%%%%%@@@@@##############%######*#+...._***#####-.+%#=_+#####=+#################%%%%%%%%%%%%%%%%%%%%%%
        %%%%%%%%%%%%@@@@@@#############%######+#*.....-+=%####*._=%-.-*%%##++#################%%%%%%%%%%%%%%%%%%%%%%
        %%%%%%%%%%%%@@@@@@@###########%%###**#=*%......__*%%#%*..._-+**+-_--.+###############%%%%%%%%%%%%%%%%%%%%%%%
        %%%%%%%%%%%#@@@@@@@@@#########+*##%++***#**+=_...---__....===+=++***++%%##############%%%%%%%%%%%%%%%%%%%%%%
        %%%%%%%%%%%%@@@@@@@@@@########+*#*_...-.%-_-=+__.........====+####%#-=*%############@#%%%%%%%%%%%%%%%%%%%%%%
        %%%%%%%%%%%%@@@@@@@@@@@###%*##_+%=_=*###@*%*=-..........-_._-#%%@@%%=.._###########@@#%%%%%%%%%%%%%%%%%%%%%%
        %%%%%%%%%%%%#@@@@@@@@@@@##%+##.-++*#*##%%*.-*-..............-=%#@#%*..._%#########@@@#%%%%%%%%%%%%%%%%%%%%%%
        %%%%%%%%%%%%#@@@@@@@@%@@@##+*#_%+.-%%@@@%#-..=_..............._-==_...__%%#######@@@@%%%%%%%%%%%%%%%%%%%%%%%
        %%%%%%%%%%%%%%@@@@@@*=+*#@@+=%.=*_.=*%#%*-....................._____-_._%*######@@@@%%%%%%%%%%%%%%%%%%%%%%%%
        %%%%%%%%%%%%%%#@@@@@%+=+=%@*=+....__.__..__............................_%#*###%#@@@%%%%%%%%%%%%%%%%%%%%%%%%%
        %%%%%%%%%%%%%%%#@@@@@==.=*%*++_......_.__...........-.................._##%%#%%@@@%%%%%%%%%%%%%%%%%%%%%%%%%%
        %%%%%%%%%%%%%%%%@@@@@@=._-**===_....................=-.................-###*%##@@%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %%%%%%%%%%%%%%%%@@@@@@@+._-**=+=....................-=_................=#**#*##@#%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %%%%%%%%%%%%%%%%@@%@@@@@#=.-**++=....................._................+*%##%%@@#%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %%%%%%%%%%%%%%%%@@%#@@@@@@#*++*++=_....................................*#####%@@#%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %%%%%%%%%%%%%%%%@%%%@@@@@@@@@@##*++-..................____............_%#####@@@#%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %%%%%%%%%%%%%%%%#%%%@@@@@@@@@@@@@%+==_................................*@#####@@@%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %%%%%%%%%%%%%%%%%%%%@@@@@@@@@@@@@@@%++=-............................+@@@####@@%@%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %%%%%%%%%%%%%%%%%%%%@@@@#@@@@@@@@@@@@#%++=_......................_*@@@@@####%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %%%%%%%%%%%%%%%%%%%%##@#%@@@@@@@@##@@@@@@%**=_.................-%@@@@@@#####%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%#####%%@@@@@@@+*%**=_...........-+*+#@####%#####%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%##@+===++****+++===+++=++#@@#%%%####%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%@@@@@@*++==++===++++==+=++=*@@@@%%%####%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%@@@@@@#*+===+===+==++==+*#@@@@@@%%%####%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%@@@@@@@@@@%++======+*%#@@@@@@@@@@@%%###%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%@@@@@@@@@@@@@@@@###@@@@@@@@@@@@@@@@@#####%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#@@@@##%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %%%%%%%%%%%%%%%%%%%%%%%%%%%##@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@##@@@@@@@@##%%%%%%%%%%%%%%%%%%%%%%%%%
        %%%%%%%%%%%%%%%%%%%%%%##@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#@@@@@@@@@@@@@@##%%%%%%%%%%%%%%%%%%%%
        %%%%%%%%%%%%%%%%##@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#@@@@@@@@@@@@@@@@@@@@##%%%%%%%%%%%%%%
        %%%%%%%%%%%##@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#%%%%%%%%%%%
        %%%%%%%%%#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#%%%%%%%%%
        %%%%%%%%#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#%%%%%%%
        %%%%%%%#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#%%%%%%
        %%%%%%#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#%%%%%
        %%%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#%%%%




*/


let interval = null;
let ispaused = false;
let isreset = false;

const minuteHtml = document.getElementById("minute");
const secondHtml = document.getElementById("second");

minute.textContent = "00", second.textContent = "00";

let firstitle = document.title;

const start = document.getElementById("start");
start.addEventListener("click", async () => {
    if (interval) return;
    start.disabled = true;
    pause.disabled = false;
    reset.disabled = false;
    isreset = false;
    ispaused = false;
    do{
        await pomodoro();
    }
    while(!isreset);
});
function defineInterval(minute, second){
    return new Promise ((resolve) => {
        let minutevariable = minute, secondvariable = second;
        
        minuteHtml.textContent = minutevariable.toString().padStart(2, "0");
        secondHtml.textContent = secondvariable.toString().padStart(2, "0");
        function updatetitle(){
            document.title = `${minutevariable.toString().padStart(2, "0")}:${secondvariable.toString().padStart(2, "0")} - Pomodoro`;
        }
        interval = setInterval(() => {
            if (!ispaused){
                if(secondvariable === 0){
                    if(minutevariable === 0){
                        clearInterval(interval);
                        interval = null;
                        resolve();
                        return;
                    }
                    secondvariable = 60
                    minutevariable --;
                }
                secondvariable --;
                
                minuteHtml.textContent = minutevariable.toString().padStart(2, "0");
                secondHtml.textContent = secondvariable.toString().padStart(2, "0");
                updatetitle();
            }
        }, 1000);
    });
}
async function pomodoro(){
    for(let i = 0; i < 4; i++){
        await defineInterval(25,0);
        await defineInterval(5,0);
    }
    await defineInterval(15,0);
}

const pause = document.getElementById("pause");
pause.addEventListener("click", () => {
    if (!interval) return;
    ispaused = !ispaused;
    pause.textContent = ispaused ? "resume" : "pause";
});
pause.disabled = true;

const reset = document.getElementById("reset");
reset.addEventListener("click", () => {
    start.disabled = false;
    pause.disabled = true;
    reset.disabled = true;
    isreset = true;
    clearInterval(interval);
    interval = null;
    ispaused = false;
    minuteHtml.textContent = "00", secondHtml.textContent = "00";
    document.title = firstitle;
});
reset.disabled = true;